import torch
import galois


class coderMatrix(torch.nn.Module):
    def __init__(self, device):
        """
        Initializes the encoder matrices.

        Args:
            device: The device to run the encoder on.

        Returns:
            Specific encoder matrix and decoder matrix
        """
        super(coderMatrix, self).__init__()

        # Define the device
        self.device = device

    def decoder_matrix(self, encoded_nr, origin_nr):
        # Create an identity matrix of shape (239, 239)
        identity_matrix = torch.eye(origin_nr)

        # Create a zero matrix of shape (255, 239)
        full_matrix = torch.zeros(encoded_nr, origin_nr)

        # Place the identity matrix in the upper part of the full matrix
        full_matrix[:origin_nr, :origin_nr] = identity_matrix

        return full_matrix

    def forward(self, method, encoded, origin):
        # Define Hamming 7x4 matrix
        if method == "Hamming" and encoded == 7 and origin == 4:
            encode_matrix = torch.tensor([[1, 1, 0, 1],
                                          [1, 0, 1, 1],
                                          [1, 0, 0, 0],
                                          [0, 1, 1, 1],
                                          [0, 1, 0, 0],
                                          [0, 0, 1, 0],
                                          [0, 0, 0, 1]], dtype=torch.float, device=self.device)

            decode_matrix = torch.tensor([[0, 0, 1, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 1, 0, 0],
                                          [0, 0, 0, 0, 0, 1, 0],
                                          [0, 0, 0, 0, 0, 0, 1]], device=self.device, dtype=torch.float)

        # Define parity 10x5 matrix
        elif method == "Parity" and encoded == 10 and origin == 5:
            encode_matrix = torch.tensor([[1, 0, 0, 0, 0],
                                          [0, 1, 0, 0, 0],
                                          [0, 0, 1, 0, 0],
                                          [0, 0, 0, 1, 0],
                                          [0, 0, 0, 0, 1],
                                          [1, 0, 0, 0, 1],
                                          [1, 1, 0, 0, 0],
                                          [0, 1, 1, 0, 0],
                                          [0, 0, 1, 1, 0],
                                          [0, 0, 0, 1, 1]], dtype=torch.float, device=self.device)

            # encode_matrix = torch.tensor([[1, 0, 0, 0, 0],
            #                               [0, 1, 0, 0, 0],
            #                               [0, 0, 1, 0, 0],
            #                               [0, 0, 0, 1, 0],
            #                               [0, 0, 0, 0, 1],
            #                               [1, 1, 1, 1, 0],
            #                               [1, 1, 1, 0, 1],
            #                               [1, 1, 0, 1, 1],
            #                               [1, 0, 1, 1, 1],
            #                               [0, 1, 1, 1, 1]], dtype=torch.float, device=self.device) # Matrix from author

            decode_matrix = torch.tensor([[1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 1, 0, 0, 0, 0, 0]], device=self.device, dtype=torch.float)

        # Define parity 16x5 matrix
        elif method == "Parity" and encoded == 16 and origin == 5:
            encode_matrix = torch.tensor([[1, 0, 0, 0, 0],
                                          [0, 1, 0, 0, 0],
                                          [0, 0, 1, 0, 0],
                                          [0, 0, 0, 1, 0],
                                          [0, 0, 0, 0, 1],
                                          [1, 1, 1, 1, 1],
                                          [1, 1, 0, 1, 1],
                                          [1, 0, 1, 1, 0],
                                          [1, 0, 0, 1, 1],
                                          [0, 1, 1, 0, 1],
                                          [1, 1, 1, 0, 0],
                                          [0, 1, 0, 1, 1],
                                          [1, 0, 1, 0, 1],
                                          [0, 1, 0, 1, 0],
                                          [1, 0, 0, 1, 1],
                                          [0, 1, 1, 0, 0]], dtype=torch.float, device=self.device)

            # encode_matrix = torch.tensor([[1, 0, 0, 0, 0],
            #                               [1, 0, 0, 0, 1],
            #                               [1, 0, 0, 1, 0],
            #                               [1, 0, 0, 1, 1],
            #                               [1, 0, 1, 0, 0],
            #                               [1, 0, 1, 0, 1],
            #                               [1, 0, 1, 1, 0],
            #                               [1, 0, 1, 1, 1],
            #                               [1, 1, 0, 0, 0],
            #                               [1, 1, 0, 0, 1],
            #                               [1, 1, 0, 1, 0],
            #                               [1, 1, 0, 1, 1],
            #                               [1, 1, 1, 0, 0],
            #                               [1, 1, 1, 0, 1],
            #                               [1, 1, 1, 1, 0],
            #                               [1, 1, 1, 1, 1]], dtype=torch.float, device=self.device) # Matrix from Author

            decode_matrix = torch.tensor([[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]], device=self.device,
                                         dtype=torch.float)

        # Define parity 20x7 matrix
        elif method == "Parity" and encoded == 20 and origin == 7:
            encode_matrix = torch.tensor([[1, 0, 0, 0, 0, 0, 0],
                                          [0, 1, 0, 0, 0, 0, 0],
                                          [0, 0, 1, 0, 0, 0, 0],
                                          [0, 0, 0, 1, 0, 0, 0],
                                          [0, 0, 0, 0, 1, 0, 0],
                                          [0, 0, 0, 0, 0, 1, 0],
                                          [0, 0, 0, 0, 0, 0, 1],
                                          [0, 0, 0, 0, 0, 1, 0],
                                          [0, 1, 1, 0, 1, 0, 1],
                                          [1, 0, 1, 1, 1, 0, 0],
                                          [1, 0, 1, 1, 0, 1, 1],
                                          [0, 0, 0, 0, 0, 0, 0],
                                          [0, 1, 1, 0, 0, 1, 1],
                                          [1, 1, 1, 1, 1, 1, 0],
                                          [0, 1, 0, 0, 0, 1, 1],
                                          [0, 0, 0, 1, 0, 1, 1],
                                          [1, 1, 0, 1, 1, 0, 0],
                                          [0, 0, 1, 1, 1, 0, 1],
                                          [1, 1, 0, 0, 0, 1, 1],
                                          [1, 0, 0, 0, 0, 1, 0]], dtype=torch.float, device=self.device)

            decode_matrix = torch.tensor([[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
                                         device=self.device, dtype=torch.float)

        # Define parity 20x10 matrix
        elif method == "Parity" and encoded == 20 and origin == 10:
            encode_matrix = torch.tensor([[1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 1, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 1, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
                                          [1, 1, 1, 1, 1, 1, 0, 0, 1, 0],
                                          [0, 0, 1, 0, 0, 1, 0, 1, 1, 1],
                                          [0, 1, 0, 1, 1, 1, 1, 1, 0, 0],
                                          [1, 0, 0, 1, 1, 1, 0, 1, 0, 0],
                                          [0, 1, 1, 0, 1, 1, 1, 1, 0, 0],
                                          [1, 0, 0, 0, 1, 1, 1, 0, 1, 1],
                                          [1, 1, 1, 0, 1, 1, 0, 0, 0, 1],
                                          [0, 0, 1, 0, 1, 0, 1, 1, 1, 1],
                                          [1, 1, 1, 1, 0, 1, 0, 1, 1, 0],
                                          [0, 1, 0, 1, 0, 1, 0, 1, 0, 1]], dtype=torch.float, device=self.device)

            decode_matrix = torch.tensor([[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          ], device=self.device, dtype=torch.float)

        # Define parity 26x10 matrix
        elif method == "Parity" and encoded == 26 and origin == 10:
            encode_matrix = torch.tensor([[1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 1, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 1, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [1, 0, 0, 0, 1, 0, 1, 0, 0, 1],
                                          [0, 0, 1, 1, 0, 1, 1, 1, 0, 1],
                                          [0, 0, 1, 0, 1, 0, 0, 1, 1, 0],
                                          [1, 1, 0, 0, 0, 0, 1, 1, 1, 0],
                                          [1, 0, 1, 0, 1, 0, 1, 1, 0, 0],
                                          [1, 0, 0, 0, 1, 0, 1, 0, 1, 0],
                                          [0, 0, 1, 0, 1, 1, 0, 1, 0, 1],
                                          [1, 1, 1, 1, 1, 0, 0, 1, 0, 1],
                                          [1, 1, 1, 1, 1, 1, 0, 0, 1, 0],
                                          [0, 1, 0, 0, 1, 1, 1, 0, 1, 0],
                                          [0, 1, 1, 1, 0, 0, 1, 1, 1, 0],
                                          [1, 0, 1, 1, 0, 0, 0, 0, 1, 1],
                                          [0, 1, 1, 0, 1, 0, 1, 0, 0, 1]], dtype=torch.float,
                                         device=self.device)  # Matrix from author

            # encode_matrix = torch.tensor([[1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            #                        [0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
            #                        [0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
            #                        [0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
            #                        [0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
            #                        [0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
            #                        [0, 0, 0, 0, 0, 0, 1, 0, 0, 0],
            #                        [0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
            #                        [0, 0, 0, 0, 0, 0, 0, 0, 1, 0],
            #                        [0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            #                        [1, 1, 1, 1, 1, 1, 1, 1, 0, 1],
            #                        [1, 0, 0, 1, 0, 1, 1, 0, 1, 0],
            #                        [1, 0, 1, 0, 0, 0, 1, 0, 0, 1],
            #                        [0, 1, 1, 1, 0, 1, 0, 0, 1, 1],
            #                        [1, 0, 0, 1, 0, 1, 1, 1, 1, 1],
            #                        [1, 1, 1, 1, 0, 1, 0, 0, 0, 1],
            #                        [1, 1, 1, 1, 1, 1, 0, 1, 0, 0],
            #                        [1, 0, 0, 0, 1, 1, 1, 0, 1, 0],
            #                        [1, 0, 0, 1, 0, 1, 0, 1, 0, 0],
            #                        [1, 1, 1, 0, 0, 0, 0, 1, 0, 1],
            #                        [1, 1, 0, 0, 0, 1, 0, 1, 0, 0],
            #                        [0, 1, 1, 1, 1, 1, 1, 1, 0, 1],
            #                        [0, 1, 1, 1, 1, 0, 1, 1, 1, 1],
            #                        [1, 0, 1, 0, 0, 0, 0, 0, 1, 1],
            #                        [0, 1, 1, 1, 1, 1, 1, 1, 0, 0],
            #                        [0, 0, 1, 0, 0, 0, 0, 1, 0, 1]], dtype=torch.float, device=self.device)

            decode_matrix = torch.tensor(
                [[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                 [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                 [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                 [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                 [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                 [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                 [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                 [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                 [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                 [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]], device=self.device,
                dtype=torch.float)

        # Define parity 30x12 matrix
        elif method == "Parity" and encoded == 30 and origin == 12:
            encode_matrix = torch.tensor([[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0],
                                          [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
                                          [1, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1],
                                          [0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0],
                                          [0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1],
                                          [1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1],
                                          [1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0],
                                          [1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0],
                                          [0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1],
                                          [1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1],
                                          [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0],
                                          [0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1],
                                          [0, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1],
                                          [1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1],
                                          [0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1],
                                          [0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1],
                                          [0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                                          [1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0],
                                          [1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1]], dtype=torch.float,
                                         device=self.device)  # Matrix from author

            decode_matrix = torch.tensor(
                [[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                 [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                 [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                 [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                 [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                 [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                 [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                 [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                 [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                 [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                 [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                 [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
                device=self.device, dtype=torch.float)  # decoder matrix for author

            # encode_matrix = torch.tensor([[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            #                        [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            #                        [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            #                        [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
            #                        [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
            #                        [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
            #                        [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
            #                        [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
            #                        [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0],
            #                        [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
            #                        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0],
            #                        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            #                        [0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0],
            #                        [1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0],
            #                        [1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1],
            #                        [0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0],
            #                        [1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1],
            #                        [1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0],
            #                        [1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0],
            #                        [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1],
            #                        [1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1],
            #                        [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0],
            #                        [1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0],
            #                        [0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0],
            #                        [0, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, 1],
            #                        [1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1],
            #                        [0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0],
            #                        [0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0],
            #                        [0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0],
            #                        [0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0]], dtype=torch.float, device=self.device)

            # decode_matrix = torch.tensor([[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            #                    [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            #                    [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            #                    [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            #                    [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            #                    [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            #                    [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            #                    [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            #                    [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            #                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            #                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            #                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]], device=self.device, dtype=torch.float)

        # Define parity 34x12 matrix
        elif method == "Parity" and encoded == 34 and origin == 12:
            # encode_matrix = torch.tensor([[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            #                        [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            #                        [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            #                        [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
            #                        [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
            #                        [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
            #                        [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
            #                        [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
            #                        [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0],
            #                        [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
            #                        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0],
            #                        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            #                        [0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 0],
            #                        [1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0],
            #                        [0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0],
            #                        [1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0],
            #                        [0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0],
            #                        [0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0],
            #                        [0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0],
            #                        [1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0],
            #                        [1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1],
            #                        [1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0],
            #                        [0, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1],
            #                        [0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1],
            #                        [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0],
            #                        [1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1],
            #                        [1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1],
            #                        [1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1],
            #                        [0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0],
            #                        [0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 0],
            #                        [0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1],
            #                        [1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1],
            #                        [1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1],
            #                        [0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1]], dtype=torch.float, device=self.device)

            encode_matrix = torch.tensor([[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
                                          [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
                                          [1, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1],
                                          [0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0],
                                          [0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1],
                                          [1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1],
                                          [1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0],
                                          [1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0],
                                          [0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1],
                                          [1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1],
                                          [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0],
                                          [0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1],
                                          [0, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1],
                                          [1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1],
                                          [0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1],
                                          [0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1],
                                          [0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                                          [1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0],
                                          [1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1],
                                          [0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1],
                                          [1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1],
                                          [0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1]], dtype=torch.float,
                                         device=self.device)  # Matrix from author

            decode_matrix = torch.tensor([
                [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
                device=self.device, dtype=torch.float)

        # Define LDPC 49x24 matrix
        elif method == "LDPC" and encoded == 49 and origin == 24:
            encode_matrix = torch.tensor([
                [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
                [1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0],
                [1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1],
                [0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0],
                [1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0],
                [0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0],
                [1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0],
                [1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1],
                [1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0],
                [1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1],
                [1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1],
                [0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0],
                [0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0],
                [1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0],
                [1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1],
                [0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1],
                [0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1],
                [0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 1],
                [0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1],
                [0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1],
                [0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0],
                [1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0],
                [1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1],
                [0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1],
                [0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1],
                [1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1]], dtype=torch.float,
                device=self.device)

            decode_matrix = torch.tensor([
                [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
            ], device=self.device, dtype=torch.float)

        # Define BCH matrix
        elif method == "BCH":
            bch = galois.BCH(encoded, origin)
            encode_matrix = torch.tensor(bch.G).clone().t().to(dtype=torch.float, device=self.device)

            decode_matrix = self.decoder_matrix(encoded, origin)
            decode_matrix = decode_matrix.clone().detach().to(dtype=torch.float, device=self.device)
            decode_matrix = decode_matrix.T

        # Define Golay 24x12 matrix
        elif method == "Golay" and encoded == 24 and origin == 12:
            encode_matrix = torch.tensor([[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
                                          [1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1],
                                          [1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1],
                                          [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1],
                                          [1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0],
                                          [1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1],
                                          [0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1],
                                          [0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1],
                                          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
                                          [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0],
                                          [1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0],
                                          [1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0]], dtype=torch.float, device=self.device)

            decode_matrix = torch.tensor([
                [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
                device=self.device, dtype=torch.float)

        return encode_matrix, decode_matrix

def ParitycheckMatrix(encoded, origin, method, device):
    """
    Generate parity check matrix.

    Parameters:
    encoded (int): The number of encoded bits.
    origin (int): The number of original bits.
    method (str): The encoding method.

    Returns:
    torch.Tensor: The parity check matrix.
    """
    # Define Hamming matrix
    # Define Hamming 7x4 matrix
    if method == "Hamming" and encoded == 7 and origin == 4:
        H = torch.tensor([[[1, 0, 1, 0, 1, 0, 1],
                           [0, 1, 1, 0, 0, 1, 1],
                           [0, 0, 0, 1, 1, 1, 1]]], dtype=torch.float, device=device)  # Hamming(7,4) BP

    # Define parity 10x5 matrix
    elif method == "Parity" and encoded == 10 and origin == 5:
        H = torch.tensor([[[1, 0, 0, 0, 1, 1, 0, 0, 0, 0],
        [1, 1, 0, 0, 0, 0, 1, 0, 0, 0],
        [0, 1, 1, 0, 0, 0, 0, 1, 0, 0],
        [0, 0, 1, 1, 0, 0, 0, 0, 1, 0],
        [0, 0, 0, 1, 1, 0, 0, 0, 0, 1]]], dtype=torch.float,device=device)  # Parity(10,5) BP

    # Define parity 20x7 matrix
    elif method == "Parity" and encoded == 20 and origin == 7:
        H = torch.tensor([[[0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           [0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           [1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           [1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
                           [0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
                           [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
                           [0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
                           [0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
                           [1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0],
                           [0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
                           [1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0],
                           [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]]], dtype=torch.float, device=device)  # Parity(20,7) BP

    # Define parity 26x10 matrix
    elif method == "Parity" and encoded == 26 and origin == 10:
        H = torch.tensor([[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           [1, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           [0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           [0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           [1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           [1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
                           [1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
                           [0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
                           [1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
                           [1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
                           [0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0],
                           [0, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
                           [1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0],
                           [0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]]], dtype=torch.float, device=device)  # Parity(26,10) BP

    # Define BCH matrix
    elif method == "BCH" and encoded == 31 and origin == 21:
        H = torch.tensor(
            [[[1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
              [0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0],
              [0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0],
              [0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0],
              [0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0],
              [0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0],
              [0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0],
              [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0],
              [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0],
              [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1]]], dtype=torch.float, device=device)  # BCH(31,21) BP

    # Define Golay 24x12 matrix
    elif method == "Golay" and encoded == 24 and origin == 12:
        H = torch.tensor([[[1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           [1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           [1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           [1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
                           [1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
                           [0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
                           [0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
                           [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
                           [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0],
                           [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
                           [1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0],
                           [1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]]], dtype=torch.float, device=device)  # Golay(24,12) BP

    return H